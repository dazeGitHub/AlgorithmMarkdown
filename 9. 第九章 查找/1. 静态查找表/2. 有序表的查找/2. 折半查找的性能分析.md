
#### 折半查找的性能分析

##### 1. 折半查找在查找成功时的比较次数

先看上述 11 个元素的表的具体例子。从上述查找过程可知：

找到第 6 个元素仅需比较 1 次；找到第 3 和第 9 个元素需比较 2 次；找到第 1、4、7 和 10 个元素需比较 3 次；找到第 2、5、8 和 11 个元素需比较 4 次。

![](https://gitee.com/mayundaze/img_bed/raw/master/20200709134213.png)

这个查找过程可用图 9.2 所示的二叉树来描述。树中每个结点表示表中一个记录，结点中的值为该记录在表中的位置，通常称这个描述査找过程的二叉树为判定树，从判定树上可见，查找 21 的过程恰好是走了一条从根到结点④的略径，和给定值进行比较的关键字个数 为该路径上的结点数或结点 4 在判定树上的层次数。

类似地，找到有序表中任一记录的过程就是走了一条从根结点到与该记录相应的结点的路径，和给定值进行比较的关键字个数恰为该结点在判定树上的层次数。因此，折半查找法在查找成功时进行比较的关键字个数最多不超过树的深度，而具有 n 个结点的判定树的深度为 $\left\lfloor\log _{2} n\right\rfloor+1$, 所以，折半查找法在査找成功时和给定值进行比较的关键字个数至多为 $\left\lfloor\log _{2} n\right\rfloor+1$

##### 2. 折半查找在查找不成功时的比较次数

如果在图 9.2 所示判定树中所有结点的空指针域上加一个指向一个方形结点的指针，如图 9.3 所示。并且，称这些方形结点为判定树的外部结点（与之相对，称那些圆形结点为内部结点），那么折半查找时查找不成功的过程就是走了一条从根结点到外部结点的路径，和给定值进行比较的关键字个数等于该路径上内部结点个数，例如：查找 85 的过程即为走了一条从根到结点 $9-10$ 的路径。因此，折半查找在查找不成功时和给定值进行比较的关键字个数最多也不超过 $\left\lfloor\log _{2} n\right\rfloor+1$

![](https://gitee.com/mayundaze/img_bed/raw/master/20200709135150.png)

##### 3. 折半查找的平均查找长度

为讨论方便起见，假定有序表的长度 $n=2^{h}-1$（反之，$h = log_2 (n + 1)$，则描述折半査找的判定树是深度为 h 的满二又树。树中层次为 1 的结点有 1 个，层次为 2 的结点有 2 个，...，层次为 h 的结点有 $2^{h - 1}$ 个，假设表中每个记录的查找概率相等 $\left(P_{i} = \Large\frac{1}{n}\normalsize\right)$，则查找成功时折半查找的平均查找长度

$\qquad\begin{aligned} A S L_{b s} &=\sum_{i=1}^{n} P_{i} C_{i} \\ &=\frac{1}{n} \sum_{j=1}^{h} j \cdot 2^{j-1} \\ &=\frac{n+1}{n} \log _{2}(n+1)-1 \qquad\qquad\qquad (9-5)\end{aligned}$

> 推导过程:
>
> $\begin{aligned} A S L_{n} &=\sum_{i=1}^{n} P_{i} C_{i} \\&= \frac{1}{n} \sum_{i=1}^{n} C_{i} \\&= \frac{1}{n} \sum_{j=1}^{n} j \cdot 2^{j-1} \\& =\frac{1}{n}\left(\sum_{i=0}^{n-1} 2^{i}+2 \sum_{i=0}^{n-2} 2^{i}+\cdots+2^{n-1} \sum_{i=0}^{0} 2^{i}\right) \\ &=\frac{1}{n}\left[h \cdot 2^{n}-\left(2^{0}+2^{1}+\cdots+2^{n-1}\right)\right] \\&= \frac{1}{n}\left[(h-1) 2^{n}+1\right] \\ &=\frac{1}{n}\left[(n+1)\left(\log _{2}(n+1)-1\right)+1\right] \\&= \frac{n+1}{n} \log _{2}(n+1)-1 \end{aligned}$

对任意的 n，当 n 较大（n > 50) 时，可有下列近似结果

$\qquad ASL_{bs} = log_{2}(n + 1) - 1 \qquad (9-6)$

##### 4. 总结

可见，折半查找的效率比顺序查找高，但折半查找只适用于有序表，且限于顺序存储结构（对线性链表无法有效地进行折半查找）。
