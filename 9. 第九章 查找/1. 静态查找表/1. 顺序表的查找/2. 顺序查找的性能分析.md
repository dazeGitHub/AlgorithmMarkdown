
#### 查找操作的性能分析

##### 1. 衡量查找算法的好坏

在第 1 章中曾提及，衡量一个算法好坏的量度有 3 条：

$(1)$ 时间复杂度（衡量算法执行的时间量级）
$(2)$ 空间复杂度（衡量算法的数据结构所占存储以及大量的附加存储）
$(3)$ 算法的其他性能

对于查找算法来说，通常只需要一个或几个辅助空间。又因为査找算法中的基本操作是“将记录的关键字和给定值进行比较”，因此，通常以“其关键字和给定值进行过比较的记录个数的平均值”作为衡量查找算法好坏的依据。

##### 2. 平均查找长度

**定义**：为确定记录在査找表中的位置，需和给定值进行比较的关键字个数的期望值称为査找算法在查找成功时的 **平均查找长度（Average Search Length）**。

对于含有 n 个记录的表，查找成功时的平均查找长度为

$\qquad\begin{aligned} ASL = \sum_{i = 1}^{n} P_{i} C_{i} \end{aligned} \qquad\qquad\qquad\qquad\qquad\qquad\qquad (9 - 1)$

其中：

$P_i$ 为査找表中第 i 个记录的概率，且 $\begin{aligned} \sum_{i=1}^{n} P_{i} = 1 \end{aligned}$

$C_i$ 为找到表中其关键字与给定值相等的第 i 个记录时，和给定值已进行过比较的关键字个数。显然，$C_i$ 随查找过程不同而不同。

从顺序查找的过程可见，$C_i$ 取决于所查记录在表中的位置。如：查找表中最后一个记录时，仅需比较一次；而査找表中第一个记录时，则需比较 n 次。一般情况下 C1 等于 $n - i + 1$。

假设 $n = ST.length$，则顺序查找的平均查找长度为

$\qquad ASL = nP_{1} + (n - 1)P_{2} + \cdots + 2P_{n-1} + P_{n} \qquad (9 - 2)$

假设每个记录的查找概率相等，即

$\qquad P_{i} = 1 / n$

则在等概率情况下顺序査找的平均查找长度为

$\begin{aligned} A S L_{s s} &=\sum_{i=1}^{n} P_{i} C_{i} \end{aligned}$

$\begin{aligned}\qquad\quad\; = \frac{1}{n} \sum_{i=1}^{n}(n-i+1) \end{aligned}$

$\begin{aligned}\qquad\quad\; = \frac{1}{n} (n + n - 1 + \cdots 1) \end{aligned}$

$\begin{aligned}\qquad\quad\; = \frac{1}{n} \cdot \frac{n (n + 1)}{2}\end{aligned}$

$\begin{aligned}\qquad\quad\; = \frac{n + 1}{2} \end{aligned} \qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\; (9-3)$

##### 3. 表中各记录查找概率不等的情况

有时，表中各个记录的查找概率并不相等。例如：将全校学生的病历档案建立一张表存放在计算机中，则体弱多病同学的病历记录的査找概率必定高于健康同学的病历记录。由于式（9-2) 中的 ASL 在 $P_{n} \geqslant P_{n-1} \geqslant \cdots \geqslant P_{2} \geqslant P_{1}$ 时达到极小值。因此，对记录的查找概率不等的查找表若能预先得知每个记录的查找概率，则应先对记录的查找概率进行排序，使表中记录按查找概率由小至大重新排列，以便提高査找效率。

然而，在一般情况下，记录的査找概率预先无法测定。为了提高查找效率，我们可以在每个记录中附设一个访问频度域，并使顺序表中的记录始终保持按访问频度非递减有序的次序排列，使得查找概率大的记录在査找过程中不断往后移，以便在以后的逐次查找中减少比较次数。或者在每次査找之后都将刚査找到的记录直接移至表尾。

##### 4. 顺序查找的优缺点

###### 缺点

顺序查找和我们后面将要讨论到的其他査找算法相比，其缺点是平均査找长度较大，特别是当 n 很大时，查找效率较低。

###### 优点

然而，它有很大的优点是：算法简单且适应面广。它对表的结构无任何要求，无论记录是否按关键字有序均可应用，而且，上述所有讨论对线性链表也同样适用。

> 若表中所有记录的关键字满足下列关系 
> $\qquad ST. elem[i]. key \leqslant ST. elem[i + 1]. key i=1,2, \cdots, n-1$ 
> 则称表中记录按关键字有序。

##### 5. 关于 “查找不成功” 的问题

容易看出，上述对平均查找长度的讨论是在 $\begin{aligned}\sum_{i=1}^{n} P_{i} = 1 \end{aligned}$ 的前提下进行的，换句话说我们认为每次査找都是“成功”的。在本章开始时曾提到，査找可能产生“成功”与“不成功”两种结果，但在实际应用的大多数情况下，查找成功的可能性比不成功的可能性大得多，特别是在表中记录数 n 很大时，査找不成功的概率可以忽略不计。

当查找不成功的情形不能忽视时，査找算法的平均查找长度应是 查找成功时的平均查找长度 与 查找不成功时的平均査找长度之和。

对于顺序查找，不论给定值 key 为何值，查找不成功时和给定值进行比较的关键字个数均为 $n + 1$。假设査找成功与不成功的可能性相同，对每个记录的查找概率也相等，则 $P_i = 1 / (2n)$，此时顺序查找的平均査找长度为

$\qquad\begin{aligned} A S L_{ss}^{\prime} &=\frac{1}{2 n} \sum_{i=1}^{n}(n-i+1)+\frac{1}{2}(n+1) \\ &=\frac{3}{4}(n+1) \end{aligned} \qquad\qquad\qquad\;\; (9-4)$

在本章的以后各节中，仅讨论查找成功时的平均查找长度和查找不成功时的比较次数，但哈希表例外。