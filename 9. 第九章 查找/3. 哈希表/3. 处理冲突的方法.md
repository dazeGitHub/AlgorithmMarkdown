
#### 处理冲突的方法

在 “9.3.1 什么是哈希表” 中曾提及均匀的哈希函数可以减少冲突，但不能避免，因此，如何处理冲突是哈希造表不可缺少的另一方面。

假设哈希表的地址集为 $0~(n - 1)$，冲突是指由关键字得到的哈希地址为 $j(0 \leq j \leq n - 1)$ 的位置上已存有记录，则“处理冲突”就是为该关键字的记录找到另一个“空”的哈希地址。在处理冲突的过程中可能得到一个地址序列 $H_i:i = 1,2,\cdots, k,\left(H_{i} \in[0, n-1]\right))$。即在处理哈希地址的冲突时，若得到的另一个哈希地址 $H_1$ 仍然发生冲突，则再求下一个地址 $H_2$, 若 $H_2$ 仍然冲突，再求得 $H_3$。依次类推，直至 $H_k$ 不发生冲突为止，则 $H_k$ 为记录在表中的地址。

通常用的处理冲突的方法有下列几种：

##### 1. 开放定址法

$H_{i} = \left(H(key) + d_{i}\right)$ \;MOD\; $m \quad i = 1,2, \cdots, k(k \leqslant m - 1)$

其中：$H(key)$ 为哈希函数；$m$ 为哈希表表长；$d$ 为增量序列，可有下列 3 种取法：

$(1)$ $d_{i} = 1,2,3, \cdots, m-1$ 称线性探测再散列；

$(2)$ $d_{i}=1^{2},-1^{2}, 2^{2},-2^{2}, 3^{2}, \cdots, \pm k^{2},(k \leqslant $m / 2)$ 称二次探测再散列；

$(3)$ $d_i =$ 伪随机数序列，称伪随机探测再散列。

例如，在长度为 11 的哈希表中已填有关键字分别为 17,60,29 的记录（哈希函数 $H(key) = key \;MOD\; 11$），现有第四个记录，其关键字为 38, 由哈希函数得到哈希地址为 5, 产生冲突。若用线性探测再散列的方法处理时，得到下一个地址 6, 仍冲突；再求下个地址 7, 仍冲突；直到哈希地址为 8 的位置为“空”时止，处理冲突的过程结束，记录填入哈希表中序号为 8 的位置。若用二次探测再散列，则应该填人序号为 4 的位置。类似地可得到伪随机再散列的地址（参见图 9.25)。

![](https://gitee.com/mayundaze/img_bed/raw/master/20200729100251.png)

> 当使用二次探测再散列时，$38 \;MOD\; 11 = 5$，产生冲突，然后令 $d_{i} = 1$，
> $\quad (38 + d_{i}) \;MOD\; 11 = (38 + 1) \;MOD\; 11 = 6$
> 仍然产生冲突，继续令 $d_{i} = 2$，则有
> $\quad (38 + d_{i}) \;MOD\; 11 = (38 + (- 1^{2})) \;MOD\; 11 = (38 - 1) \;MOD\; 11 = 37 \;MOD\; 11 = 4$
> 正好和图 $9.25(c)$ 相符
>
> $38 + 伪随机数列 9 = 47$，$47 \; MOD \; 11 = 3$，正好和图 $9.25(d)$ 相符

从上述线性探测再散列的过程中可以看到一个现象：当表中 i, i + 1, i + 2 位置上已填有记录时，下一个哈希地址为 i,i + 1,i + 2 和 i + 3 的记录都将填入 i + 3 的位置，这种在处理冲突过程中发生的两个第一个哈希地址不同的记录争夺同一个后继哈希地址的现象称做 **“二次聚集”**，即在处理同义词的冲突过程中又添加了非同义词的冲突，显然，这种现象对查找不利。但另一方面，用线性探测再散列处理冲突可以保证做到：只要哈希表未填满，总能找到一个不发生冲突的地址 H，而二次探测再散列只有在哈希表长 m 为形如 $4j + 3(j 为整数)$ 的素数时オ可能，随机探测再散列，则取决于伪随机数列。

##### 2. 再哈希法

$\qquad H_{i} = R H_{i}(\text {key}) \quad i = 1,2, \cdots, k  \qquad\qquad (9-26)$

$RH_i$ 均是不同的哈希函数，即在同义词产生地址冲突时计算另一个哈希函数地址，直到冲突不再发生。这种方法不易产生“聚集”，但增加了计算的时间

##### 3. 链地址法

将所有关键字为同义词的记录存储在同一线性链表中。假设某哈希函数产生的哈希地址在区间 $[0,m - 1]$ 上，则设立一个指针型向量 `Chain Chainhash [m]`，其每个分量的初始状态都是空指针。凡哈希地址为 $i$ 的记录都插入到头指针为 `Chainhash [i]` 的链表中。在链表中的插入位置可以在表头或表尾；也可以在中间，以保持同义词在同一线性链表中按关键字有序

###### 例 9-3

见 `实例/1. 例 9-3.md`

##### 4. 建立一个公共溢出区

这也是处理冲突的一种方法。假设哈希函数的值域为 $[0,m - 1]$，则设向量 HashTable $[0.. m - 1]$ 为基本表，每个分量存放一个记录，另设立向量 Overtable $[0 .. v]$ 为溢出表。所有关键字和基本表中关键字为同义词的记录，不管它们由哈希函数得到的哈希地址是什么，一且发生冲突，都填入溢出表。
