
#### B 减树的删除

反之，若在 B 树上删除一个关键字，则首先应找到该关键字所在结点，并从中删除之，若该结点为最下层的非终端结点，且其中的关键字数目不少于 $\lceil m / 2\rceil$，则删除完成，否则要进行“合并”结点的操作。假若所删关键字为非终端结点中的 $K_i$，则可以指针 $A_i$ 所指子树中的最小关键字 Y 替代 $K_i$，然后在相应的结点中删去 Y。

例如，在图 $9.16(a)$ 的 B- 树上删去 45, 可以 $*f$ 结点中的 50 替代 45, 然后在 $*f$ 结点中删去 50。

![](https://gitee.com/mayundaze/img_bed/raw/master/20200713165605.png)

因此，下面我们可以只需讨论删除最下层非终端结点中的关键字的情形。有下列 3 种可能：

$(1)$ 被删关键字所在结点中的关键字数目不小于 $\lceil m / 2\rceil$，则只需从该结点中删去该关键字 $K_i$ 和相应指针 $A_i$，树的其他部分不变，例如，从图 $9.16(a)$ 所示 B- 树中删去关键字 12, 删除后的 B- 树如图 $9.17(a)$ 所示。
$(2)$ 被删关键字所在结点中的关键字数目等于 $\lceil m / 2\rceil -1$，而与该结点相邻的右兄弟 (或左兄弟)结点中的关键字数目大于 $\lceil m / 2\rceil -1$,则需将其兄弟结点中的最小（或最大）的关键字上移至双亲结点中，而将双亲结点中小于（或大于）且紧靠该上移关键字的关键字下移至被删关键字所在结点中。

例如，从图 $9.17(a)$ 中删去 50, 需将其右兄弟结点中的 61 上移至 $*e$ 结点中，而将 $*e$ 结点中的 53 移至 $*f$，从而使 $*f$ 和 $*g$ 中关键字数目均不小于 $\lceil m / 2\rceil -1$,而双亲结点中的关键字数目不变，如图 $9.17(b)$ 所示。

$(3)$ 被删关键字所在结点和其相邻的兄弟结点中的关键字数目均等于 $\lceil m / 2\rceil-1$，假设该结点有右兄弟，且其右兄弟结点地址由双亲结点中的指针 $A_i$ 所指，则在删去关键字之后，它所在结点中剩余的关键字和指针，加上双亲结点中的关键字 $K_i$ 一起，合并到 $A_i$ 所指兄弟结点中（若没有右兄弟，则合并至左兄弟结点中）。

例如，从图 $9.17(b)$ 所示 B- 树中删去 53, 则应删去 $*f$ 结点，并将 $*f$ 中的剩余信息（指针“空”）和双亲 $*e$ 结点中的 61 一起合并到右兄弟结点 $*g$ 中。删除后的树如图 $9.17(c)$ 所示。如果因此使双亲结 点中的关键字数目小于 $:\lceil m / 2\rceil-1$，则依次类推作相应处理。

例如，在图 $9.17(c)$ 的 B- 树中删去关键字 37 之后，双亲 b 结点中剩余信息（“指针 c”）应和其双亲 $*a$ 结点中关键字 45 起合并至右兄弟结点 $*e$ 中，删除后的 B 树如图 $9.17(d)$ 所示。

![](https://gitee.com/mayundaze/img_bed/raw/master/20200713181834.png)

> 从 a 到 b，删除 50，从 b 到 c 删除 53，从 c 到 d 删除 37

在 B- 树中删除结点的算法在此不再详述，请读者参阅参考书目 [1] 后自己写出。
