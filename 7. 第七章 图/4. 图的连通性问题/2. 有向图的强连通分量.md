
#### 有向图的强连通分量

##### 1. 求强连通分量的步骤

深度优先搜索是求有向图的强连通分量的一个新的有效方法。假设以十字链表作有向图的存储结构，则求强连通分量的步骤如下：

$\quad (1)$ 在有向图 G 上，从某个顶点出发沿以该顶点为尾的弧进行深度优先搜索遍历，并按其所有邻接点的搜索都完成（即退出 DFS 函数）的顺序将顶点排列起来。此时需对 7.3.1 中的算法作如下两点修改：

$\qquad (a)$ 在进入 Dfstraverse 函数时首先进行计数变量的初始化，即在人口处加上 `count=0` 的语句；

$\qquad (b)$ 在退出 DFS 函数之前将完成捜索的顶点号记录在另一个辅助数组 `finished[vexnum]` 中，即在 DFS 函数结束之前加上 `finished[++ count] = v` 的语句。

$\quad (2)$ 在有向图 G 上，从最后完成捜索的顶点（即 `finished[vexnum - 1]` 中的顶点）出发，沿着以该顶点为头的弧作逆向的深度优先搜索遍历，若此次遍历不能访问到有向图中所有顶点，则从余下的顶点中最后完成搜索的那个顶点出发，继续作逆向的深度优先搜索遍历，依次类推，直至有向图中所有顶点都被访问到为止。此时调用 Dfstraverse 时需作如下修改：函数中第二个循环语句的边界条件应改为 v 从 `finished[vexnum - 1]` 至 `finished[0]`

由此，每一次调用 DFS 作逆向深度优先遍历所访向到的顶点集便是有向图 G 中一个强连通分量的顶点集。

![](https://gitee.com/mayundaze/img_bed/raw/master/20200702154902.png)

例如图 7.11 所示的有向图，假设从顶点出发作深度优先搜索遍历，得到 finished 数组中的顶点号为 `(1,3,2,0)`；则再从顶点 $v_1$ 出发作逆向的深度优先搜索遍历，得到两个顶点集 $\left\{v_{1}, v_{3}, v_{4}\right\}$ 和 $\{2\}$，这就是该有向图的两个强连通分量的顶点集。

上述求强连通分量的第二步，其实质为：

$\quad (1)$ 构造一个有向图 G，设 $G = (V,\{A\})$，则 $G_{r}=\left(V,\left\{A_{r}\right\}\right)$，对于所有 $\left\langle v_{i}, v_{j}\right\rangle \in A$，必有 $\left\langle v_{j}, v_{i}\right\rangle \in A_{r}$。即 $G_r$ 中拥有和 $G$ 方向相反的弧；

$\quad (2)$ 在有向图 $G_r$ 上，从顶点 `finished[vexnum - 1]` 出发作深度优先搜索遍历。可以证明，在 $G_r$ 上所得深度优先生成森林中每一棵树的顶点集即为 $G$ 的强连通分量的顶点集。

显然，利用遍历求强连通分量的时间复杂度亦和遍历相同。