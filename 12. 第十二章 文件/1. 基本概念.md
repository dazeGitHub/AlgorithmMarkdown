
和表类似，文件是大量记录的集合。习惯上称存储在主存储器（内存储器）中的记录集合为表，称存储在二级存储器（外存储器）中的记录集合为文件。本章讨论文件在外存储器中的表示方法及其各种运算的实现方法。

#### 有关文件的基本概念

##### 1. 文件及其类别

###### 按照记录的类型分类

文件（file）是由大量性质相同的记录组成的集合。可按其记录的类型不同而分成两类：`操作系统的文件` 和 `数据库文件`。

操作系统中的文件仅是一维的连续的字符序列，无结构、无解释。它也是记录的集合，这个记录仅是一个字符组，用户为了存取、加工方便，把文件中的信息划分成若干组，每一组信息称为一个逻辑记录，且可按顺序编号。

数据库中的文件是带有结构的记录的集合；这类记录是由一个或多个数据项组成的集合，它也是文件中可存取的数据的基本单位。数据项是最基本的不可分的数据单位，也是文件中可使用的数据的最小单位。例如，图 12.1 所示为一个数据库文件，每个学生的情况是一个记录，它由 10 个数据项组成。

![](https://gitee.com/mayundaze/img_bed/raw/master/20200805172041.png)

###### 按照记录的特性分类

文件还可按记录的另一特性分成定长记录文件和不定长记录文件。若文件中每个记录含有的信息长度相同，则称这类记录为定长记录，由这类记录组成的文件称做 **定长记录文件**；若文件中含有信息长度不等的不定长记录，则称 **不定长记录文件**。

数据库文件还可按记录中关键字的多少分成单关键字文件和多关键字文件。若文件中的记录只有一个性一标识记录的主关键字，则称单关键字文件；若文件中的记录除了含有一个主关键字外，还含有若干个次关键字，则称为多关键字文件，记录中所有非关键字的数据项称为记录的属性。

##### 2. 记录的逻辑结构和物理结构

记录的逻辑结构是指记录在用户或应用程序员面前呈现的方式，是用户对数据的表示和存取方式。

记录的物理结构是数据在物理存储器上存储的方式，是数据的物理表示和组织

通常，记录的逻辑结构着眼在用户使用方便，而记录的物理结构则应考虑提高存储空间的利用率和减少存取记录的时间，它根据不同的需要及设备本身的特性可以有多种方式。从 11.1 节的讨论中已得知: 一个物理记录指的是计算机用一条 I/O 命令进行读写的基本数据单位，对于固定的设备和操作系统，它的大小基本上是固定不变的，而逻辑记录的大小是由使用要求定的。在物理记录和逻辑记录之间可能存在下列 3 种关系：

$(1)$ 一个物理记录存放一个逻辑记录
$(2)$ 一个物理记录包含多个逻辑记录。
$(3)$ 多个物理记录表示一个逻辑记录。

总之,用户读/写ー个记录是指逻辑记录,査找对应的物理记录则是操作系统的职责, 图 12.2 简单表示了这种关系。图中的逻辑记录和物理记录满足上述第一种关系，物理记录之间用指针相链接。

![](https://gitee.com/mayundaze/img_bed/raw/master/20200805172740.png)

##### 3. 文件的操作 (运算)

文件的操作有两类：`检索` 和 `修改`

###### 文件的检索有下列 3 种方式

$(1)$ 顺序存取：存取下一个逻辑记录
$(2)$ 直接存取：存取第 i 个逻辑记录

以上两种存取方式都是根据记录序号（即记录存人文件时的顺序编号）或记录的相对位置进行存取的。

$(3)$ 按关键字存取：给定一个值，査询一个或一批关键字与给定值相关的记录。对数据库文件可以有如下 4 种查询方式:

① 简单询问：查询关键字等于给定值的记录。例如，在图 12.1 的文件中，给定一个准考证号码或学生姓名，查询相关记录。
② 区域询向：査询关键字属某个区域内的记录。例如，在图 12.1 的文件中査询某某中学的学生成绩，则给定准考证号的某个数值范围。
③ 函数询问：给定关键字的某个函数。例如查询总分在全体学生的平均分以上的记录或处于中值的记录。
④ 布尔询问：以上 3 种询问用布尔运算组合起来的询问。例如，査询总分在 600 分以上且数学在 100 分以上，或者总分在平均分以下的外语在 98 分以上的全部记录。

文件的修改包括插入一个记录、删除一个记录和更新一个记录 3 种操作。

文件的操作可以有实时和批量两种不同方式。通常实时处理对应答时间要求严格，应在接收询问之后几秒钟内完成检索和修改，而批量处理则不然。不同的文件系统其使用有不同的要求。例如，一个民航自动服务系统，其检索和修改都应实时处理；而银行的账户系统縉实时检索，但可进行批量修改，即可以将一天的存款和提款记录在一个事务文件上，在一天的营业之后再进行批量处理。

##### 4. 文件的物理结构

文件在存储介质（磁盘或磁带）上的组织方式称为文件的物理结构。

文件可以有各种各样的组织方式，其基本方式有 3 种：`顺序组织`、`随机组织` 和 `链组织`。

一个特定的文件应采用何种物理结构应综合考虑各种因素，如：存储介质的类型、记录的类型、大小和关键字的数目以及对文件作何种操作等。本章将介绍几种常用的文件的物理结构。