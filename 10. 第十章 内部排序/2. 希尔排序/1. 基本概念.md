
#### 希尔排序

希尔排序（Shell's Sort）又称“缩小增量排序”（Diminishing Increment Sort），它也是种属插入排序类的方法，但在时间效率上较前述几种排序方法有较大的改进。

从对直接插入排序的分析得知，其算法时间复杂度为 $O(n^2)$，但是，若待排记录序列为“正序”时，其时间复杂度可提高至 $O(n)$。由此可设想，若待排记录序列按关键字“基本有序”，即序列中具有下列特性

$\begin{aligned}\qquad L. r[i]. key<\max _{1 \leqslant j < i}\{\text { L. } r[j] . \text { key }\} \end{aligned} \qquad\qquad (10-7)$

的记录较少时，直接插入排序的效率就可大大提高，从另ー方面来看，由于直接插人排序算法简单，则在 $n$ 值很小时效率也比较高。希尔排序正是从这两点分析出发对直接插入排序进行改进得到的一种插人排序方法。

##### 基本思想

它的基本思想是：先将整个待排记录序列分割成为若干子序列分别进行直接插人排序，待整个序列中的记录“基本有序”时，再对全体记录进行一次直接插人排序。

仍以式（10-4) 中的关键字为例，先看一下希尔排序的过程。

$\qquad R(49), R(38), R(65), R(97), R(76), R(13), R(27), R(\overline{49}), \cdots \quad(10-4)$

初始关键字序列如图 10.5 的第 1 行所示:

1. 首先将该序列分成 5 个子序列 $\left\{R_{1}, R_{6}\right\},\left\{R_{2}, R_{7}\right\}, \cdots,\left\{R_{5}, R_{10}\right\}$，如图 10.5 的第 2 行至第 6 行所示，分别对每个子序列进行直接插入排序，排序结果如图 10.5 的第 7 行所示，从第 1 行的初始序列得到第 7 行的序列的过程称为一趟希尔排序。
2. 然后进行第二趟希尔排序，即分别对下列 3 个子序列：$\left\{R_{1}, R_{4}, R_{7}, R_{10}\right\},\left\{R_{2}, R_{5}, R_{8}\right\}$ 和 $\left\{R_{3}, R_{6}, R_{9}\right\}$ 进行直接插人排序，其结果如图 10.5 的第 11 行所示，最后对整个序列进行趟直接插入排序。至此，希尔排序结束，整个序列的记录已按关键字非递减有序排列。

![](https://gitee.com/mayundaze/img_bed/raw/master/20200803101929.png)

从上述排序过程可见，希尔排序的一个特点是：子序列的构成不是简单地“逐段分割”，而是将相隔某个“增量”的记录组成一个子序列。

如上例中，第一趟排序时的增量为 5, 第二趟排序时的增量为 3, 由于在前两趟的插入排序中记录的关键字是和同一子序列中的前一个记录的关键字进行比较，因此关键字较小的记录就不是一步一步地往前挪动，而是跳跃式地往前移，从而使得在进行最后一趟增量为 1 的插入排序时，序列已基本有序，只要作记录的少量比较和移动即可完成排序，因此希尔排序的时间复杂度较直接插入排序低。

下面用算法语言描述上述希尔排序的过程，为此先将算法 10.1 改写成如算法 10.4 所示的一般形式。希尔排序算法如算法 10.5 所示。

###### 算法 10.4

```cpp
Void Shellinsert (Alist&L, int k) f

    //对顺序表工作一趟希尔插入排序。本算法是和一趟直接插入排序相比，作了以下修改：
    // 1. 前后记录位置的增量是咏，而不是 1;
    // 2. r[0] 只是暂存单元，不是哨兵。当 j<=0 时，插入位置已找到。

    for(i = dk + 1; i <= L.length; ++ i){
        if(LT(L.r[i].key, L.r[i - dk].key){      //需将 L.r[i] 插入有序增量子表
            L.r[0] = L.r[i];                     //暂存在 L.r[O]
            for(j = i - dk; j > 0 && LT(L.r[0].key, L.r[i].key); j -= dk)
                L.r[j + dk] = L.r[j];            //记录后移，查找插入位置
            L.r[j + dk] = L.r[0];                //插入
        }
    }
}//ShellInsert
```

###### 算法 10.5

```cpp
void ShellSort (Sqlist & L, int dlta[], int t) ( //按增量序列 dlta[0 .. t - 1] 对顺序表 L 作希尔排序。
    for (k = 0; k < t; ++ k)
        ShellInsert(L, dlta[k]);                 //一趟增量为 dlta[k] 的插入排序 
}// Shell Sort
```
